# Xcode Project Setup Guide
**For MagnetarStudio Native macOS App**

---

## Quick Start (Recommended)

### Option 1: Create Project in Xcode (5 minutes)

1. **Open Xcode 16**
   ```bash
   open -a Xcode
   ```

2. **Create New Project**
   - File â†’ New â†’ Project...
   - Choose **macOS** â†’ **App**
   - Click **Next**

3. **Configure Project**
   - **Product Name:** `MagnetarStudio`
   - **Team:** (Select your Apple Developer team)
   - **Organization Identifier:** `com.magnetar` (or your domain)
   - **Bundle Identifier:** `com.magnetar.studio`
   - **Interface:** **SwiftUI**
   - **Language:** **Swift**
   - **Storage:** **SwiftData** âœ…
   - Click **Next**

4. **Save Location**
   - Navigate to: `/Users/indiedevhipps/Documents/MagnetarStudio/apps/native/`
   - **IMPORTANT:** Uncheck "Create Git repository" (already in parent repo)
   - Click **Create**

5. **Add Existing Files**
   - In Xcode, **delete** the generated files:
     - `ContentView.swift` (we have our own)
     - `MagnetarStudioApp.swift` (we have our own)
     - `Item.swift` (not needed)

   - Right-click project in Navigator â†’ **Add Files to "MagnetarStudio"...**
   - Select these folders:
     - `Shared/` (add entire folder, create groups)
     - `macOS/` (add entire folder, create groups)
   - **Options:**
     - âœ… Copy items if needed: **NO** (already in project)
     - âœ… Create groups
     - âœ… Add to targets: **MagnetarStudio**

6. **Configure Build Settings**
   - Select project in Navigator
   - **General** tab:
     - **Deployment Target:** macOS 14.0 (or 15.0 for Tahoe 26)
     - **Minimum System Version:** macOS 14.0

   - **Signing & Capabilities** tab:
     - Select your Development Team
     - Add capability: **Keychain Sharing**
       - Add keychain group: `com.magnetar.studio`
     - Add capability: **Hardened Runtime**
       - Enable: "Outgoing Connections (Client)"
       - Enable: "Incoming Connections (Server)" (for P2P)

7. **Add Asset Catalog Colors**
   - Open `Assets.xcassets`
   - Add Color Sets:
     - **MagnetarPrimary:** `#3B82F6` (blue)
     - **MagnetarSecondary:** `#8B5CF6` (purple)
     - **MagnetarAccent:** `#06B6D4` (cyan)
   - For each: Set "Any Appearance" and "Dark Appearance" variants

8. **Build & Run** ðŸš€
   - Press **âŒ˜R** or click **Run** button
   - App should launch!

---

## Option 2: Manual Project File (Advanced)

If you want to create the `.xcodeproj` manually:

### 1. Create Project Directory Structure

```bash
cd /Users/indiedevhipps/Documents/MagnetarStudio/apps/native
mkdir -p MagnetarStudio.xcodeproj
```

### 2. Copy Template (TBD - complex)

Creating a `.pbxproj` file manually is extremely complex. **Use Option 1 instead.**

---

## Troubleshooting

### Build Errors

**Error: "No such module 'Observation'"**
- Solution: Set deployment target to macOS 14.0+
- Observation framework requires macOS Sonoma or later

**Error: "Cannot find 'User' in scope"**
- Solution: Make sure all files in `Shared/Models/` are added to target
- Check target membership (right-click file â†’ Show File Inspector)

**Error: "Value of type 'UIDevice' has no member 'current'"**
- Solution: UIDevice is iOS-only. In APIClient.swift, replace with:
  ```swift
  deviceFingerprint: nil  // Or use macOS alternative
  ```

### Keychain Errors

**Error: "Operation couldn't be completed. (OSStatus error -34018.)"**
- Solution: In Build Settings â†’ Signing:
  - Enable "Automatically manage signing"
  - Add Keychain Sharing capability
  - Restart Xcode

### SwiftData Errors

**Error: "No model context in environment"**
- Solution: In `MagnetarStudioApp.swift`, add:
  ```swift
  .modelContainer(for: [User.self, ChatMessage.self, ChatSession.self])
  ```

---

## File Structure After Setup

```
apps/native/
â”œâ”€â”€ MagnetarStudio.xcodeproj/      # Generated by Xcode
â”‚   â”œâ”€â”€ project.pbxproj
â”‚   â””â”€â”€ xcuserdata/
â”œâ”€â”€ Shared/                         # Already exists
â”‚   â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ Stores/
â”‚   â”œâ”€â”€ Security/
â”‚   â”œâ”€â”€ Networking/
â”‚   â”œâ”€â”€ DesignSystem/
â”‚   â””â”€â”€ Utilities/
â”œâ”€â”€ macOS/                          # Already exists
â”‚   â”œâ”€â”€ MagnetarStudioApp.swift
â”‚   â”œâ”€â”€ ContentView.swift
â”‚   â”œâ”€â”€ Info.plist
â”‚   â””â”€â”€ Workspaces/
â”œâ”€â”€ Resources/                      # Created by Xcode
â”‚   â””â”€â”€ Assets.xcassets
â””â”€â”€ README.md
```

---

## Next Steps After Build

### 1. Test Authentication
- App launches â†’ Login screen appears
- Enter username/password
- Face ID prompt appears (on supported Mac)
- Login successful â†’ Main app appears

### 2. Test Navigation
- Sidebar shows: Team, Chat, Database, Kanban
- Click Chat â†’ Chat workspace appears
- Press âŒ˜2 â†’ Should switch to Chat
- Press âŒ˜1 â†’ Should switch to Team

### 3. Test Chat
- Click "New Chat Session"
- Type message in input field
- Press Enter or click Send
- Simulated AI response appears (backend not connected yet)

### 4. Test Liquid Glass
- Transparent blur effects should be visible
- Gradient buttons should have hover effects
- Dark mode toggle (macOS System Preferences) should work

---

## Backend Integration (After Build Works)

Once app builds successfully, connect to FastAPI backend:

### 1. Start Backend
```bash
cd /Users/indiedevhipps/Documents/MagnetarStudio
source venv/bin/activate  # If using venv
python3 apps/backend/api/app_factory.py
```

Backend should start at `http://localhost:8000`

### 2. Update APIClient (if needed)
In `Shared/Networking/APIClient.swift`:
```swift
private let baseURL = URL(string: "http://localhost:8000/api/v1")!
```

### 3. Test Login
- Backend must be running
- Create test user in backend (or use existing)
- Login in Mac app should now actually authenticate

---

## Common Questions

**Q: Do I need to pay for Apple Developer Program?**
A: No, for local development. You can sign with a free Apple ID.

**Q: What macOS version do I need?**
A: macOS Sonoma (14.0) or later. Preferably Tahoe (26.0) for Liquid Glass.

**Q: Can I run this on Intel Mac?**
A: Yes, but some features (M5 Neural Accelerators) won't be available. App will still work.

**Q: How do I add Swift Package dependencies?**
A: File â†’ Add Package Dependencies... in Xcode. Or use Package.swift (we'll add later).

---

## Support

If you encounter issues:

1. **Check build errors** in Xcode (âŒ˜B to build)
2. **Clean build folder** (Product â†’ Clean Build Folder)
3. **Restart Xcode** (fixes 90% of mysterious issues)
4. **Check file target membership** (right-click file â†’ Show File Inspector)

**Ready to build? Follow Option 1 above!** ðŸš€
